# Ecommerce Platform - Environment Configuration Template
# Copy this file to .env and update with your values
# NEVER commit .env to version control

# =============================================================================
# Application Environment
# =============================================================================
NODE_ENV=development
LOG_LEVEL=info
PORT=3000

# =============================================================================
# PostgreSQL (Transactional Data)
# =============================================================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=ecommerce
POSTGRES_PASSWORD=dev_password
POSTGRES_DB=ecommerce
POSTGRES_MAX_CONNECTIONS=20
POSTGRES_SSL_MODE=disable

# Connection string format for different services
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# =============================================================================
# MongoDB (Product Catalog)
# =============================================================================
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_USER=ecommerce
MONGO_PASSWORD=dev_password
MONGO_DB=catalog
MONGO_AUTH_SOURCE=admin

# Connection string
MONGODB_URI=mongodb://${MONGO_USER}:${MONGO_PASSWORD}@${MONGO_HOST}:${MONGO_PORT}/${MONGO_DB}?authSource=${MONGO_AUTH_SOURCE}

# =============================================================================
# Redis (Caching & Sessions)
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=dev_password
REDIS_DB=0
REDIS_MAX_RETRIES=3
REDIS_CONNECT_TIMEOUT=5000

# Connection string
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# =============================================================================
# OpenSearch (Product Search & Logs)
# =============================================================================
OPENSEARCH_HOST=localhost
OPENSEARCH_PORT=9200
OPENSEARCH_PROTOCOL=http
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=admin

# Connection string
OPENSEARCH_URL=${OPENSEARCH_PROTOCOL}://${OPENSEARCH_USERNAME}:${OPENSEARCH_PASSWORD}@${OPENSEARCH_HOST}:${OPENSEARCH_PORT}

# =============================================================================
# Apache Kafka (Event Streaming)
# =============================================================================
KAFKA_BROKERS=localhost:9093
KAFKA_CLIENT_ID=ecommerce-platform
KAFKA_GROUP_ID=ecommerce-consumers
KAFKA_RETRY_ATTEMPTS=5
KAFKA_RETRY_BACKOFF_MS=1000

# Schema Registry
SCHEMA_REGISTRY_URL=http://localhost:8081

# Topic names
KAFKA_TOPIC_ORDER_EVENTS=order-events
KAFKA_TOPIC_INVENTORY_EVENTS=inventory-events
KAFKA_TOPIC_PAYMENT_EVENTS=payment-events
KAFKA_TOPIC_USER_EVENTS=user-events
KAFKA_TOPIC_PRODUCT_EVENTS=product-events

# =============================================================================
# RabbitMQ (Task Queues)
# =============================================================================
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=ecommerce
RABBITMQ_PASSWORD=dev_password
RABBITMQ_VHOST=/
RABBITMQ_MANAGEMENT_PORT=15672

# Connection string
RABBITMQ_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}/${RABBITMQ_VHOST}

# =============================================================================
# API Gateway (Kong)
# =============================================================================
KONG_ADMIN_URL=http://localhost:8001
KONG_PROXY_URL=http://localhost:8000
KONG_ADMIN_TOKEN=changeme

# =============================================================================
# Observability - OpenTelemetry
# =============================================================================
OTEL_SERVICE_NAME=ecommerce-service
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=1.0
OTEL_LOGS_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp

# =============================================================================
# Observability - Prometheus
# =============================================================================
PROMETHEUS_URL=http://localhost:9090
PROMETHEUS_PUSHGATEWAY_URL=http://localhost:9091
METRICS_PORT=9100

# =============================================================================
# Observability - Jaeger (Distributed Tracing)
# =============================================================================
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831
JAEGER_COLLECTOR_ENDPOINT=http://localhost:14268/api/traces
JAEGER_UI_URL=http://localhost:16686

# =============================================================================
# Observability - Grafana
# =============================================================================
GRAFANA_URL=http://localhost:3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# =============================================================================
# Security - HashiCorp Vault
# =============================================================================
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=dev-token
VAULT_NAMESPACE=ecommerce
VAULT_MOUNT_PATH=secret

# =============================================================================
# Security - JWT Authentication
# =============================================================================
JWT_SECRET=changeme_use_long_random_string_here
JWT_EXPIRATION=24h
JWT_REFRESH_EXPIRATION=7d
JWT_ALGORITHM=HS256

# =============================================================================
# Security - Encryption
# =============================================================================
ENCRYPTION_KEY=changeme_32_character_string_here
ENCRYPTION_ALGORITHM=aes-256-gcm

# =============================================================================
# Security - Service-to-Service Authentication
# =============================================================================
# API keys for inter-service communication
# Generate secure random keys for production (e.g., using openssl rand -base64 32)
CART_SERVICE_API_KEY=changeme_use_long_random_string_here
ORDER_SERVICE_API_KEY=changeme_use_long_random_string_here
PAYMENT_SERVICE_API_KEY=changeme_use_long_random_string_here
INVENTORY_SERVICE_API_KEY=changeme_use_long_random_string_here
CATALOG_SERVICE_API_KEY=changeme_use_long_random_string_here

# =============================================================================
# Payment Gateway (Stripe)
# =============================================================================
STRIPE_SECRET_KEY=sk_test_changeme
STRIPE_PUBLISHABLE_KEY=pk_test_changeme
STRIPE_WEBHOOK_SECRET=whsec_changeme
STRIPE_API_VERSION=2023-10-16

# =============================================================================
# Email Service
# =============================================================================
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@ecommerce-platform.com
SMTP_FROM_NAME=Ecommerce Platform

# Email service provider (sendgrid, ses, mailgun)
EMAIL_PROVIDER=smtp

# SendGrid (if using)
SENDGRID_API_KEY=

# AWS SES (if using)
AWS_SES_REGION=us-east-1
AWS_SES_ACCESS_KEY_ID=
AWS_SES_SECRET_ACCESS_KEY=

# =============================================================================
# Object Storage (MinIO / S3)
# =============================================================================
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin
S3_BUCKET_NAME=ecommerce-assets
S3_REGION=us-east-1
S3_USE_SSL=false

# =============================================================================
# Frontend - Next.js Customer Web
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=${STRIPE_PUBLISHABLE_KEY}
NEXT_PUBLIC_GOOGLE_ANALYTICS_ID=
NEXT_PUBLIC_SENTRY_DSN=

# =============================================================================
# Frontend - Admin Dashboard (Remix)
# =============================================================================
ADMIN_API_URL=http://localhost:8000
SESSION_SECRET=changeme_use_long_random_string_here

# =============================================================================
# Service URLs (Internal)
# =============================================================================
CATALOG_SERVICE_URL=http://localhost:5001
CART_SERVICE_URL=http://localhost:5002
CHECKOUT_SERVICE_URL=http://localhost:5003
PAYMENT_SERVICE_URL=http://localhost:5004
INVENTORY_SERVICE_URL=http://localhost:5005
ORDERS_SERVICE_URL=http://localhost:5006
FULFILLMENT_SERVICE_URL=http://localhost:5007
ACCOUNTS_SERVICE_URL=http://localhost:5008
RECOMMENDATIONS_SERVICE_URL=http://localhost:5009
API_GATEWAY_URL=http://localhost:8000

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# =============================================================================
# CORS Configuration
# =============================================================================
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Correlation-ID

# =============================================================================
# Feature Flags
# =============================================================================
FEATURE_RECOMMENDATIONS_ENABLED=true
FEATURE_REVIEWS_ENABLED=true
FEATURE_WISHLIST_ENABLED=false
FEATURE_LIVE_CHAT_ENABLED=false

# =============================================================================
# Cache TTL (in seconds)
# =============================================================================
CACHE_TTL_PRODUCTS=3600
CACHE_TTL_CATEGORIES=7200
CACHE_TTL_CART=1800
CACHE_TTL_USER_SESSION=86400

# =============================================================================
# Business Rules
# =============================================================================
CART_EXPIRATION_HOURS=24
INVENTORY_RESERVATION_MINUTES=10
MAX_CART_ITEMS=50
MAX_CHECKOUT_ATTEMPTS=3
ORDER_CANCELLATION_WINDOW_HOURS=24

# =============================================================================
# SLO Targets (for monitoring)
# =============================================================================
SLO_AVAILABILITY_CHECKOUT=99.9
SLO_AVAILABILITY_BROWSE=99.95
SLO_LATENCY_P95_MS=300
SLO_LATENCY_P99_MS=2000
SLO_ERROR_RATE_MAX=0.1

# =============================================================================
# Testing
# =============================================================================
TEST_DATABASE_URL=postgresql://ecommerce:test_password@localhost:5433/ecommerce_test
TEST_MONGODB_URI=mongodb://ecommerce:test_password@localhost:27018/catalog_test
TEST_REDIS_URL=redis://:test_password@localhost:6380/1

# =============================================================================
# Development Tools
# =============================================================================
# Adminer (Database UI)
ADMINER_PORT=8080

# MailHog (Email testing)
MAILHOG_SMTP_PORT=1025
MAILHOG_UI_PORT=8025

# =============================================================================
# CI/CD
# =============================================================================
CI=false
SKIP_PREFLIGHT_CHECK=true
GENERATE_SOURCEMAP=false

# SonarQube
SONAR_HOST_URL=http://localhost:9000
SONAR_TOKEN=
SONAR_PROJECT_KEY=ecommerce-platform

# =============================================================================
# Docker Build Args
# =============================================================================
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1
